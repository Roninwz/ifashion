if("undefined"==typeof CYZS)var CYZS={};CYZS.PopUpPanelView=CYZS.BaseView.extend({contentHtml:"",initialize:function(){if(arguments&&1==arguments.length){var e=arguments[0];for(var i in e)this[i]=e[i]}CYZS.BaseView.prototype.initialize.apply(this,arguments)},events:{"click .pop-up-close-layer":"onCloseClick","click .pop-up-panel-wrap .btn-close":"onCloseClick"},initElView:function(){var e=template("tpl_popUpPanelWrap");this.$el.html(e),this.$el.find(".js-content-wrap").html(this.contentHtml)},centerPos:function(){var e=this,i=e.$el.find(".pop-up-panel-wrap"),t=i.width(),n=i.height();i.css({"margin-left":-t/2+"px","margin-top":-n/2+"px"})},onCloseClick:function(e){this.$el.remove()}});
var AppDownLoadPopView=CYZS.PopUpPanelView.extend({initElView:function(){var e=Cookies.get("webFrom");e||(e="pcweb"),this.contentHtml=template("tpl_appDownloadPop",{fValue:e}),CYZS.PopUpPanelView.prototype.initElView.apply(this,arguments),CYZS.Util.renderQRCode(this.$el.find("#js_downloadQRLink"),{width:160,height:160,typeNumber:-1,background:"#ffffff",foreground:"#000000",correctLevel:3,text:"http://ichuanyi.com/get/?f="+e})}});
var PcHeaderView={staticUrl:{URL_PC_SUIR_RECOMMEND:{url:"pc/page/suit_recommend",ordinal:1},URL_PC_GOODS_RECOMMEND:{url:"pc/page/goods_recommend",ordinal:2},URL_PC_MEDIA:{url:"pc/page/fashion_daily",ordinal:3},URL_PC_BRAND_STREET:{url:"pc/page/brand_street",ordinal:4},URL_TOMORROW:{url:"pc/page/tomorrow",ordinal:1},URL_SUIT_TAG:{url:"pc/page/suit_tag",ordinal:1},URL_GOODS_TAG:{url:"pc/page/goods_tag",ordinal:2},URL_MEDIA:{url:"pc/page/media",ordinal:3}},initialize:function(){this.bindHeaderNavDownloadBtn(),this.setNavActive(),this.bindScrollTop(),this.bindGoToTop()},bindHeaderNavDownloadBtn:function(){$(".js_header_nav_btn").bind("click",function(){var n=new AppDownLoadPopView;$("body").append(n.$el),n.centerPos()})},setNavActive:function(){var n=window.location.href,o=this,i=$(".header-container .nav-container li.nav-item"),a=0;_.each(o.staticUrl,function(o,i){a=n.indexOf(o.url)>0?o.ordinal:a}),i.removeClass("active").eq(a).addClass("active")},bindScrollTop:function(){var n=$(window).height(),o=0,i=$(".return-top");$(window).bind("scroll",function(){o=$(window).scrollTop(),o>n?i.show():i.hide()})},bindGoToTop:function(){$(".js_return_top_btn").on("click",function(){var n=$(window).scrollTop(),o=null;o=setInterval(function(){n=(n/1.3).toFixed(2),1>n&&(n=Math.floor(n)),0>=n&&clearInterval(o),$(window).scrollTop(n)},30)})}};PcHeaderView.initialize();
var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?81f958da40dae4d146ef160171e49c7e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
var SuitRecommendPageView=CYZS.ModuleView.extend({tplId:"suitRecommendTpl",tplData:{},initElView:function(){var e=this;e.setPageTitle("搭配-穿衣助手"),CYZS.ModuleView.prototype.initElView.apply(this,arguments);var e=this,t={method:"suit.index"};CYZS.AjaxHelper.ajax({data:t,onSuccess:function(t){e.tplData=t.data,new SuitMenuView({el:$(".js_all_menu_container"),dataObj:e.tplData}),new TomorrowRecommend({el:$(".js_tomorrow_suit_recommend_container"),dataObj:e.tplData})}});var a=new WaterfallView;this.$el.find(".js_waterfall_container").append(a.$el),this.initBreadcrumb({links:[{link:"",name:"搭配"}]})}});
var SuitCellView=CYZS.ModuleView.extend({tplId:"suitCellTpl",initElView:function(){this.dataObj.image=CYZS.Util.formatDFSUrl(this.dataObj.image),this.dataObj.avatar=CYZS.Util.formatDFSUrl(this.dataObj.avatar),this.$el.append(template(this.tplId,this.dataObj)),this.$el.addClass("js-waterfall-cell-wrap")}});
!function(t,i,e,s){"use strict";function n(i,e){this.$element=t(i),this.options=t.extend(!0,{},r,e),this.colHeightArray=[],this.styleQueue=[],this._init()}var o=t(i),a="waterfall",r={itemCls:"waterfall-item",prefix:"waterfall",fitWidth:!0,colWidth:240,gutterWidth:10,gutterHeight:10,align:"center",minCol:1,maxCol:s,maxPage:s,bufferPixel:-50,containerStyle:{position:"relative"},resizable:!0,isFadeIn:!1,isAnimated:!1,animationOptions:{},isAutoPrefill:!0,checkImagesLoaded:!0,path:s,dataType:"json",params:{},headers:{},loadingMsg:'<div style="text-align:center;padding:10px 0; color:#999;"><img src="data:image/gif;base64,R0lGODlhEAALAPQAAP///zMzM+Li4tra2u7u7jk5OTMzM1hYWJubm4CAgMjIyE9PT29vb6KiooODg8vLy1JSUjc3N3Jycuvr6+Dg4Pb29mBgYOPj4/X19cXFxbOzs9XV1fHx8TMzMzMzMzMzMyH5BAkLAAAAIf4aQ3JlYXRlZCB3aXRoIGFqYXhsb2FkLmluZm8AIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7" alt=""><br />Loading...</div>',state:{isDuringAjax:!1,isProcessingData:!1,isResizing:!1,isPause:!1,curPage:1},callbacks:{loadingStart:function(t){t.show()},loadingFinished:function(t,i){i?t.remove():t.fadeOut()},loadingError:function(t){t.html("Data load faild, please try again later.")},renderData:function(i,e){var s,n;return"json"===e||"jsonp"===e?(s=t("#waterfall-tpl").html(),(n=Handlebars.compile(s))(i)):i}},debug:!1};n.prototype={constructor:n,_debug:function(){!0===this.options.debug&&("undefined"!=typeof console&&"function"==typeof console.log?1===Array.prototype.slice.call(arguments).length&&"string"==typeof Array.prototype.slice.call(arguments)[0]?console.log(""+Array.prototype.slice.call(arguments)):console.log(Array.prototype.slice.call(arguments)):Function.prototype.bind||"undefined"==typeof console||"object"!=typeof console.log||Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments)))},_init:function(t){var i=this.options,e=i.path;return this._setColumns(),this._initContainer(),this._resetColumnsHeightArray(),this.reLayout(t),e?(i.isAutoPrefill&&this._prefill(),i.resizable&&this._doResize(),this._doScroll(),s):(this._debug("Invalid path"),s)},_initContainer:function(){var i=this.options,e=i.prefix;t("body").css({"overflow-y":"scroll","overflow-x":"hidden"}),this.$element.css({"overflow-x":"hidden","overflow-y":"hidden"}),this.$element.css(this.options.containerStyle).addClass(e+"-container"),this.$element.after('<div id="'+e+'-loading">'+i.loadingMsg+'</div><div id="'+e+'-message" style="text-align:center;color:#999;"></div>'),this.$loading=t("#"+e+"-loading"),this.$message=t("#"+e+"-message")},_getColumns:function(){var t=this.options,i=t.fitWidth?this.$element.parent():this.$element,e="BODY"===i[0].tagName?i.width()-20:i.width(),s=t.colWidth,n=t.gutterWidth,o=t.minCol,a=t.maxCol,r=Math.floor(e/(s+n)),l=Math.max(r,o);return a&&l>a?a:l},_setColumns:function(){this.cols=this._getColumns()},_getItems:function(t){var i=t.filter("."+this.options.itemCls).css({position:"absolute"});return i},_resetColumnsHeightArray:function(){var t,i=this.cols;for(this.colHeightArray.length=i,t=0;i>t;t++)this.colHeightArray[t]=0},layout:function(t,i){var e,s,n,o,a,r,l=this.options,h=this.options.isFadeIn?this._getItems(t).css({opacity:0}).animate({opacity:1}):this._getItems(t),A=this.options.isAnimated&&this.options.state.isResizing?"animate":"css",c=l.animationOptions,u=l.colWidth,d=l.gutterWidth,g=this.colHeightArray.length,p=l.align;for(this.$element.append(h),"center"===p?(e=(this.$element.width()-u*g-d*(g-1))/2,e=e>0?e:0):"left"===p?e=0:"right"===p&&(e=this.$element.width()-u*g-d*(g-1)),n=0,a=h.length;a>n;n++)this._placeItems(h[n],e);for(o=0,r=this.styleQueue.length;r>o;o++)s=this.styleQueue[o],s.$el[A](s.style,c);this.$element.height(Math.max.apply({},this.colHeightArray)),this.styleQueue=[],this.options.state.isResizing=!1,this.options.state.isProcessingData=!1,i&&i.call(h)},reLayout:function(t){var i=this.$element.find("."+this.options.itemCls);this._resetColumnsHeightArray(),this.layout(i,t)},_placeItems:function(i,e){var s,n,o=t(i),a=this.options,r=a.colWidth,l=a.gutterWidth,h=a.gutterHeight,A=this.colHeightArray,c=A.length,u=Math.min.apply({},A),d=t.inArray(u,A);s=o.hasClass(a.prefix+"-item-fixed-left")?0:o.hasClass(a.prefix+"-item-fixed-right")?c>1?c-1:0:d,n={left:(r+l)*s+e,top:A[s]},this.styleQueue.push({$el:o,style:n}),A[s]+=o.outerHeight()+h},prepend:function(t,i){this.$element.prepend(t),this.reLayout(i)},append:function(t,i){this.$element.append(t),this.reLayout(i)},removeItems:function(t,i){this.$element.find(t).remove(),this.reLayout(i)},option:function(i,e){t.isPlainObject(i)&&(this.options=t.extend(!0,this.options,i),"function"==typeof e&&e(),this._init())},pause:function(t){this.options.state.isPause=!0,"function"==typeof t&&t()},resume:function(t){this.options.state.isPause=!1,"function"==typeof t&&t()},_requestData:function(i){var e,n=this,o=this.options,a=o.maxPage,r=o.state.curPage++,l=o.path,h=o.dataType,A=o.params,c=o.headers;return a!==s&&r>a?(o.state.isBeyondMaxPage=!0,o.callbacks.loadingFinished(this.$loading,o.state.isBeyondMaxPage),s):(e="function"==typeof l?l(r):l.join(r),this._debug("heading into ajax",e+t.param(A)),o.callbacks.loadingStart(this.$loading),o.state.isDuringAjax=!0,o.state.isProcessingData=!0,t.ajax({url:e,data:A,headers:c,dataType:h,success:function(t){n._handleResponse(t,i),n.options.state.isDuringAjax=!1},error:function(){n._responeseError("error")}}),s)},_handleResponse:function(i,e){var s=this,n=this.options,o=t.trim(n.callbacks.renderData(i,n.dataType)),a=t(o),r=n.checkImagesLoaded;r?a.imagesLoaded(function(){s.append(a,e),s.options.callbacks.loadingFinished(s.$loading,s.options.state.isBeyondMaxPage)}):(s.append(a,e),s.options.callbacks.loadingFinished(s.$loading,s.options.state.isBeyondMaxPage))},_responeseError:function(t){this.$loading.hide(),this.options.callbacks.loadingError(this.$message,t),"end"!==t&&"error"!==t&&(t="unknown"),this._debug("Error",t)},_nearbottom:function(){var t=this.options,i=Math.min.apply({},this.colHeightArray),e=o.scrollTop()+o.height()-10-this.$element.offset().top-i;return this._debug("math:",e),e>t.bufferPixel},_prefill:function(){this.$element.height()<=o.height()&&this._scroll()},_scroll:function(){var t=this.options,i=t.state,e=this;i.isProcessingData||i.isDuringAjax||i.isInvalidPage||i.isPause||this._nearbottom()&&this._requestData(function(){setTimeout(function(){e._scroll()},100)})},_doScroll:function(){var t,i=this;o.bind("scroll",function(){t&&clearTimeout(t),t=setTimeout(function(){i._scroll()},100)})},_resize:function(){var t=this.cols,i=this._getColumns();(i!==t||"left"!==this.options.align)&&(this.options.state.isResizing=!0,this.cols=i,this.reLayout(),this._prefill())},_doResize:function(){var t,i=this;o.bind("resize",function(){t&&clearTimeout(t),t=setTimeout(function(){i._resize()},100)})}},t.fn[a]=function(i){if("string"==typeof i){var e=Array.prototype.slice.call(arguments,1);this.each(function(){var n=t.data(this,"plugin_"+a);return n?t.isFunction(n[i])&&"_"!==i.charAt(0)?(n[i].apply(n,e),s):(n._debug('no such method "'+i+'"'),s):(n._debug("instance is not initialization"),s)})}else this.each(function(){t.data(this,"plugin_"+a)||t.data(this,"plugin_"+a,new n(this,i))});return this}}(jQuery,window,document),function(t,i){"use strict";var e="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";t.fn.imagesLoaded=function(s){function n(){var i=t(u),e=t(d);l&&(d.length?l.reject(A,i,e):l.resolve(A)),t.isFunction(s)&&s.call(r,A,i,e)}function o(t){a(t.target,"error"===t.type)}function a(i,s){i.src!==e&&-1===t.inArray(i,c)&&(c.push(i),s?d.push(i):u.push(i),t.data(i,"imagesLoaded",{isBroken:s,src:i.src}),h&&l.notifyWith(t(i),[s,A,t(u),t(d)]),A.length===c.length&&(setTimeout(n),A.unbind(".imagesLoaded",o)))}var r=this,l=t.isFunction(t.Deferred)?t.Deferred():0,h=t.isFunction(l.notify),A=r.find("img").add(r.filter("img")),c=[],u=[],d=[];return t.isPlainObject(s)&&t.each(s,function(t,i){"callback"===t?s=i:l&&l[t](i)}),A.length?A.bind("load.imagesLoaded error.imagesLoaded",o).each(function(s,n){var o=n.src,r=t.data(n,"imagesLoaded");return r&&r.src===o?(a(n,r.isBroken),i):n.complete&&n.naturalWidth!==i?(a(n,0===n.naturalWidth||0===n.naturalHeight),i):((n.readyState||n.complete)&&(n.src=e,n.src=o),i)}):n(),l?l.promise(r):r}}(jQuery);
if("undefined"==typeof CYZS)var CYZS={};CYZS.WaterfallCpn=CYZS.ModuleView.extend({MODULE_WIDTH:"1200px",ajaxInfo:{fromPageId:0,pageSize:20,page:1},waterfallConfig:{itemCls:"js-waterfall-cell-wrap",resizable:!0,gutterWidth:0,gutterHeight:20,fitWidth:!0,maxCol:5,minCol:5,checkImagesLoaded:!1,bufferPixel:-400},$waterfall:null,waterfallData:null,initialize:function(){var a=this;this.waterfallConfig.path=function(e){return a.wfPath.apply(a,arguments)},this.waterfallConfig.callbacks={loadingFinished:function(e,t){a.wfLoadingFinished.apply(a,arguments)},renderData:function(e,t){return a.wfRenderData.apply(a,arguments)}},CYZS.ModuleView.prototype.initialize.apply(this,arguments)},initElView:function(){this.$el.html('<div class="js-content-list-wrap"></div>'),this.$waterfall=this.$el.find(".js-content-list-wrap").last(),this.initWaterfall()},initWaterfall:function(){this.$waterfall.waterfall(this.waterfallConfig),this.$waterfall.css({width:this.MODULE_WIDTH,overflow:"visible"})},renderWaterfall:function(){var a="";return a},pauseWaterfall:function(){$("#waterfall-loading").remove(),this.$waterfall.waterfall("pause")},wfPath:function(a){if(100>a){this.currentPage=a;var e="";_.each(this.ajaxInfo,function(a,t,i){e+=t+"="+a+"&"});var t=CYZS.Config.URL_PROXY+"pc.php?"+e+"page="+a;return this.ajaxInfo||(t="/api-outertest/api.php?deviceType=1&fromPageId=0&cardId=12&method=goods.getListByCard&session=AgoKAgtQBlAID0sGAApQVlENUAUPVwYDXQUBXAAMUgFSAQMMBVdUUggGA04DDFJWBgJWBAEA&userId=1387857319&version=8.2&page=1&pageSize=20"),t}return this.pauseWaterfall(),null},wfLoadingFinished:function(a,e){e?(a.remove(),this.pauseWaterfall()):(a.fadeOut(),this.$el.find("#waterfall-loading").remove()),this.bindLazyLoad()},wfRenderData:function(a,e){return"json"===e||"jsonp"===e?(this.waterfallData=a,this.renderWaterfall()):a}});
var WaterfallView=CYZS.WaterfallCpn.extend({initialize:function(){this.ajaxInfo.method="suit.getChoiceness",CYZS.WaterfallCpn.prototype.initialize.apply(this,arguments)},renderWaterfall:function(){var e=this.waterfallData.data,a=this;return!e||$.isEmptyObject(e)?this.pauseWaterfall():_.each(e,function(t,i){e[i].avatarLink="/pc/page/shop_owner/index.html?viewUserId="+t.userId,e[i].name=t.username,e[i].like=t.collectCount;var l=new SuitCellView({dataObj:e[i]});a.$waterfall.append(l.$el)}),""}});
var SuitMenuView=CYZS.ModuleView.extend({tplId:"suitMenuTpl",initElView:function(){var e=this;_.each(e.dataObj.menu,function(i,t){_.each(i.menuLv1,function(i,n){e.dataObj.menu[t].menuLv1[n].image=CYZS.Util.formatDFSUrl(i.image)}),_.each(i.menuLv2,function(i,n){e.dataObj.menu[t].menuLv2[n].image=CYZS.Util.formatDFSUrl(i.image)})}),CYZS.ModuleView.prototype.initElView.apply(this,arguments)}});
var TomorrowRecommend=CYZS.ModuleView.extend({tplId:"tomorrowRecommendTpl",tplData:{},initElView:function(){var i=this;_.each(i.dataObj.tomorrow.list,function(t,e){i.dataObj.tomorrow.list[e].image=CYZS.Util.formatDFSUrl(t.image)}),CYZS.ModuleView.prototype.initElView.apply(this,arguments),this.tplData=this.dataObj,this.firstViewRender(this.dataObj.tomorrow.list[0]),this.bindMenuClick()},bindMenuClick:function(){var i,t=this.$el.find(".recommend-menu-list .menu-item"),e=this;t.bind("click",function(){t.removeClass("active"),$(this).addClass("active"),i=t.index($(this)),e.firstViewRender(e.tplData.tomorrow.list[i])})},firstViewRender:function(i){console.log(i),this.$el.find(".js_tomorrow_recommend_main_pic").attr("src",i.image+"?imageView2/1/w/280/h/462/q/100"),this.$el.find(".js_tomorrow_recommend_main_pic").bind("click",function(){window.location.href="/pc/page/core/suit/?viewUserId="+i.userId+"&suitId="+i.suitId}),this.$el.find(".js_text").html(i.recommendDescription),this.$el.find(".js_btn").bind("click",function(){window.location.href=i.link})}});
